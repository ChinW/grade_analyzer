
Ta.Page={url:'',title:'',fullTitle:'',LAYOUT_TYPE:{DASHBOARD:1,SIDEBAR:2,NOSIDEBAR:3,HEATMAP:4},OPCODE:{NAV:1},init:function(){var self=this;this.url=decodeURIComponent(Ta.hash.get(2));var exec=function(nav){var mod=Ta.$('module');self.layoutPage(nav);self[nav]?self[nav](null,nav):function(){var url=self.getUrl();url=url+(~url.indexOf('?')?'&':'?')+'sId='+Ta.module.site.sid+'&random='+(+new Date())+'&opcode='+self.OPCODE.NAV;(url&&Ta.loadTemplate(url,function(data){Ta.util.loadAjaxData(data);self.url='';this.fullTitle&&(document.title=this.fullTitle);})||Ta.util.html(mod,'功能开发中'));}();};var speMenu={1:{20:'QQ互联',21:'纵横搜索',22:'热搜词',23:'热门版块',24:'热门主题',25:'移动互联网',26:'终端类型',27:'会员参与度',28:'游客与会员'},2:{20:'QQ互联',21:'纵横搜索',22:'热搜词',23:'热门版块',24:'热门主题',27:'会员参与度',28:'游客与会员'}};var monitorMenu={0:{0:'页面热区图',1:'网站测速',2:'网站可用性',3:'速度诊断',4:'热区图|1'},1:{0:'页面热区图',1:'网站测速',2:'网站可用性',3:'速度诊断',4:'热区图|1'},2:{0:'页面热区图',1:'网站测速',3:'速度诊断',4:'热区图|1'},3:{0:'页面热区图',1:'网站测速',2:'网站可用性',3:'速度诊断',4:'热区图|1'}};var adminMenu={10:'访问权限',11:'设置图标',12:'代码自动安装|1'};var getAdminMenu=function(isAdmin,siteType,isDemoSite){if(isDemoSite){return{};}
if(isAdmin)
{if(siteType==2){return{'功能管理':{0:'数据订阅',1:'广告设置|1',3:'波动提醒'},'站点管理':{10:'访问权限',12:'代码自动安装|1'}};}
if(siteType==0){return{'功能管理':{0:'数据订阅',1:'广告设置|1',2:'监控提醒',3:'波动提醒'},'站点管理':{10:'访问权限',11:'设置图标',12:'代码自动安装|1'}};}
return{'功能管理':{0:'数据订阅',1:'广告设置|1',2:'监控提醒',3:'波动提醒'},'站点管理':{10:'访问权限',12:'代码自动安装|1'}};}
return{'功能管理':{0:'数据订阅'}};}
var loadImg=function(){var div=document.createElement('div');div.className='loading';div.innerHTML='<img src="http://imgcache.qq.com/bossweb/ta/images/loading.gif" />';return div;}();var sitInf=Ta.module.user.site;Ta.module.site=new(Ta.bind({focus:'',sid:'',type:'2',isAdmin:false,isDemoSite:false,site:sitInf.list,events:{focus:'changeTo',sid:'setSid'},initialize:function(){var arr=[],list=Ta.$('site_list'),that=this,pop=Ta.$('div_pop_site'),tm,site=sitInf.getSite(Ta.hash.get(1));for(var l=this.site.length,i=0;i<l;i++){arr.push('<li><a href="javascript:;" title="'+this.site[i].url+'" sid="'+this.site[i].sid+'">'+this.site[i].t_url+'</a></li>');}
list.innerHTML=arr.join('');if(arr.length==0){this.sid=0;pop.style.visibility='hidden';return;}
pop.style.visiblity='';this.set({'sid':site.sid});Ta.util.addEvt(list,'click',function(evt,target){Ta.util.pageHotClick('选中站点');Ta.hash.clearHash(2);$('html,body').animate({scrollTop:'0px'},1000);var sid;(sid=target.getAttribute('sid'))&&(that.set({'focus':sid}),pop.className='');});},setSid:function(sid){var site=sitInf.getSite(sid);Ta.$('site_url').innerHTML=site.t_url;this.isAdmin=!site.isAuthorize;site.type=site.isThirdSite?0:site.is5D6DSite?2:site.isSoSoSite?3:1;this.type=site.type;this.isDemoSite=site.isDemoSite;if(this.isDemoSite){$('#i_site_setting').hide();$('#li_site_manage').hide();$('#li_msg_center').hide();$('#change_link').hide();}else{$('#i_site_setting').show();$('#li_site_manage').show();$('#ls_msg_center').show();$('#change_link').show();}
var userInfo=Ta.module.user.inf;if(32==site.diType&&'1'==userInfo.isCrmqq&&('0'==userInfo.crmGrayEnable||'1'==userInfo.isCrmGrayUin)){$("#menu_main li[menu=main-7]").show();}
else{$("#menu_main li[menu=main-7]").hide();var regExp=/7-\d/;if(Ta.hash.get(0).match(regExp)||Ta.hash.get(1).match(regExp))
window.location="http://v2.ta.qq.com/summary/index#!0-0&&"+sid;}
Ta.module.menu&&Ta.module.menu.set({'subMenu.data.1.特色功能':speMenu[this.type]||{},'subMenu.data.3.监控检测':monitorMenu[this.type]||{},'subMenu.data.5':getAdminMenu(this.isAdmin,this.type,this.isDemoSite)})},changeTo:function(data){Ta.Task&&Ta.Task.kill();Ta.hash.set(1,data);Ta.module.site.set({sid:data});},changeType:function(data){Ta.module.menu&&Ta.module.menu.set({'subMenu.data.1.特色功能':speMenu[this.type]||{},'subMenu.data.5':getAdminMenu(this.isAdmin,this.type)})}}))();if(Ta.module.site.sid==0){$('#change_link').hide();exec('6-0');return;}
Ta.module.menu=new(Ta.bind({mainMenu:{data:{0:'网站概况',1:'基础运营',2:"转化跟踪",3:'监控检测',4:'我的视图|1',5:'站点管理|1',6:'个人中心|1',7:'营销QQ'},tmpl_id:'tmpl_main_menu',menu_id:'menu_main'},subMenu:{data:{0:{},1:{'网站趋势':{0:'实时数据',1:'网站趋势',2:' 页面排行',3:'站内广告|1',4:'入口页面',5:'离开页面',6:'访问深度'},'访客分析':{10:'访客画像',11:'运营商',12:'地域',13:'客户端信息',14:'新老访客比',15:'实时访客'},'特色功能':speMenu[Ta.module.site.type]||{}},2:{'转化跟踪':{0:'全部来源',1:'搜索引擎',2:'外部链接',3:'关键词'}},3:{'监控检测':monitorMenu[Ta.module.site.type]||{}},4:{'我的视图':{0:'来源分析',1:'关键词',2:'页面排行',3:'网站测速'}},5:getAdminMenu(Ta.module.site.isAdmin,Ta.module.site.type,Ta.module.site.isDemoSite),6:{'个人中心':{0:'站点管理',1:'消息中心',2:'帮助中心'}},7:{'数据分析':{0:'服务概况',1:'企业数据',2:'详细服务情况',3:'页面排行',4:'搜索引擎'}}},tmpl_id:'',menu_id:'menu_sub'},events:{subMenu:'updateMenu'},ins:'',initialize:function(){this.render();},render:function(){var site=Ta.module.user.site.getSite(Ta.module.site.sid);site&&site.isAuthorize&&delete(this.subMenu.data[5]['站点管理']);this.ins=new Ta.Menu({main:this.mainMenu,sub:this.subMenu},this.callback);Ta.module.site.setSid(Ta.module.site.sid);},callback:function(ids,titles){var arr=[];for(var i in titles){if(titles[i]){arr.push(titles[i]);}}
self.fullTitle=arr.join('-').replace('|1','');document.title=self.fullTitle;var mod=Ta.$('module'),tt=Ta.$('tt');mod.innerHTML='';Ta.DialogManager.clearAll();Ta.util.loading('module',{top:100,bottom:100});tt&&(tt.innerHTML=titles[1]);self.title=titles[1];self.showMenuTips(0,'',false);exec(ids.join('-'));},changeMenu:function(nav,url){var arr=nav.split('-');this.ins.change(arr[0],arr[1]);},updateMenu:function(){this.ins.update();}}))();},cgi:{'0-0':'/summary/dashboard','1-0':'/features/period','1-1':'/site/index','1-2':'/site/topPage','1-3':'/ad/report','1-4':'/site/land','1-5':'/site/exit','1-6':'/visitor/depth','1-10':'/visitor/portrait','1-11':'/visitor/proxy','1-12':'/visitor/area','1-13':'/visitor/client','1-14':'/visitor/guest','1-15':'/visitor/realTime','1-20':'/cloudplatform/QQConnect','1-21':'/cloudplatform/zonghengIndex','1-22':'/cloudplatform/zonghengKeyword','1-23':'/features/forum','1-24':'/features/topic','1-25':'/wap/index','1-26':'/wap/client','1-27':'/visitor/engagement','1-28':'/features/guestMember','2-0':'/source/all','2-1':'/source/engine','2-2':'/source/out','2-3':'/source/keyword','3-0':'/heatmap/listHeatMapConf','3-1':'/speed/area','3-2':'/availability/monitor','3-3':'/speedanalysis/index','3-4':'/speed/heatMapDetail','4-0':'','4-1':'','4-2':'','4-3':'','5-0':'/setting/listOrder','5-1':'/ad/listAds','5-2':'/availability/listAlert','5-3':'/ware/getSetting','5-10':'/setting/listAuthorize','5-11':'/manage/setIcon','5-12':'/setting/installCode','6-0':'/manage/site','6-1':'/message/list','6-2':'','7-0':'/crmrpt/summary','7-1':'/crmrpt/enterprise','7-2':'/crmrpt/detail','7-3':'/crmrpt/topPage','7-4':'/crmrpt/engine'},'0-0':function(fn,nav){this.loadCustomUrl(fn,nav);},'6-0':function(fn,nav){this.loadCustomUrl(fn,nav);},'6-1':function(fn,nav){this.loadCustomUrl(fn,nav);},'3-0':function(fn,nav){var self=this;var url=self.getUrl();Ta.hash.get(2)&&(nav='3-4');url=url+(~url.indexOf('?')?'&':'?')+'sId='+Ta.module.site.sid+'&random='+(+new Date())+'&opcode='+self.OPCODE.NAV;Ta.ajax({url:url,success:function(data){self.layoutPage(nav);Ta.util.loadAjaxData(data);}});},loadCustomUrl:function(fn,nav){var self=this;Ta.Page.cgi[nav]&&(function(){Ta.ajax({url:Ta.Page.cgi[nav],success:function(data){self.layoutPage(nav);Ta.util.loadAjaxData(data);}});})();},layoutPage:function(nav){var layoutType={'0-0':this.LAYOUT_TYPE.DASHBOARD,'6-1':this.LAYOUT_TYPE.NOSIDEBAR,'6-0':this.LAYOUT_TYPE.NOSIDEBAR,'3-4':this.LAYOUT_TYPE.HEATMAP}[nav]||this.LAYOUT_TYPE.SIDEBAR;switch(layoutType){case this.LAYOUT_TYPE.SIDEBAR:$('#wrap_common').removeClass().addClass('wrapper cf');$('#time_line').hide();$('#page_title').hide();$('#sidebar').show();$('#onlineQQ').hide();break;case this.LAYOUT_TYPE.DASHBOARD:$('#wrap_common').removeClass().addClass('dashboard cf');$('#page_title').show();$('#sidebar').hide();$('#onlineQQ').show();break;case this.LAYOUT_TYPE.HEATMAP:$('#wrap_common').removeClass().addClass('full_screen cf');$('#page_title').show();$('#sidebar').hide();$('#onlineQQ').hide();break;case this.LAYOUT_TYPE.NOSIDEBAR:default:$('#wrap_common').removeClass().addClass('dashboard cf');$('#time_line').hide();$('#page_title').empty().show();$('#sidebar').hide();$('#onlineQQ').hide();break;}},update:function(ids,titles){document.title=titles.join('-').replace('|1','');var mod=Ta.$('module'),tt=Ta.$('tt');mod.innerHTML='';mod.appendChild(loadImg);tt&&(tt.innerHTML=titles[1]);exec(ids.join('-'));},changeTo:function(nav,url){var self=this;var fn=function(ids,titles){self.fullTitle=titles.join('-').replace('|1','');document.title=self.fullTitle;var mod=Ta.$('module'),tt=Ta.$('tt');nav=ids.join('-');self.layoutPage(nav);mod.innerHTML='';var loadImg=function(){var div=document.createElement('div');div.className='loading';div.innerHTML='<img src="http://imgcache.qq.com/bossweb/ta/images/loading.gif" />';return div;}();Ta.DialogManager.clearAll();mod.appendChild(loadImg);tt&&(tt.innerHTML=titles[1]);self.title=titles[1];url=url||self.getUrl();url=url+(~url.indexOf('?')?'&':'?')+'sId='+Ta.module.site.sid+'&random='+(+new Date())+'&opcode='+self.OPCODE.NAV;url&&Ta.loadTemplate(url,function(data){self.showMenuTips(0,'',false);Ta.module.subMenuTitle='';Ta.util.loadAjaxData(data);});};var arr=nav.split('-');Ta.module.menu.ins&&Ta.module.menu.ins.change(arr[0],arr[1],fn);return false;},changeToMenu:function(nav){Ta.hash.clearHash(2);$('html,body').animate({scrollTop:'0px'},1000);this.changeTo(nav);},appendSubTitle:function(subTitle,isReplace){var self=this;if(subTitle&&isReplace){$('#tt').html(subTitle);}else{var tt=Ta.$('tt');subTitle=subTitle&&(subTitle=':'+subTitle)||'';subTitle=this.title+subTitle;$('#tt').html(subTitle);}
var arr=self.fullTitle.split('-');self.fullTitle=arr[0]+'-'+subTitle;},getUrl:function(){var url=decodeURIComponent(Ta.hash.get(2))||Ta.Page.cgi[Ta.hash.get(0)];return url;},showMenuTips:function(tips,id,showClose,showTips){if(!tips){$('#tipsBar').hide();return;}
showTips?$('#tipsBar').show():$('#tipsBar').hide();$('#p_tips').html(tips);showClose?($('#a_closeTips').show().click(function(){Ta.util.pageHotClick('closeTips');$('#tipsBar').hide();})):$('#a_closeTips').hide();},loadReport:function(dateObj,conditionOpts,requestType,bfunc,afunc){var url=this.getUrl();Ta.module.report=new(Ta.bind({baseUrl:url,ajaxObj:{url:'',type:'get',dataType:'html'},dateObj:dateObj,extraParams:{},conditionOpts:conditionOpts,events:{dateObj:'renderAll',ajaxObj:'reload',extraParams:'renderAll'},dateRange:'',condition:'',beforeFunc:bfunc||'',afterFunc:afunc||'',initialize:function(){if(!conditionOpts){return;}
var dObj=this.dateObj;var __this=this;var fnc=function(obj){__this.beforeFunc&&__this.beforeFunc(obj);__this.renderAll();};var fnt=function(obj){__this.beforeFunc&&__this.beforeFunc(obj);__this.render('table');};this.condition=new Ta.Condition(this.conditionOpts,fnc,fnt);this.dateRange=new pickerDateRange('date',{isTodayValid:dObj.isTodayValid,startDate:dObj.startDate,endDate:dObj.endDate,needCompare:dObj.needCompare,startCompareDate:dObj.startCompareDate,endCompareDate:dObj.endCompareDate,singleCompare:dObj.singleCompare,defaultText:dObj.defaultText,target:'datePicker',validStartTime:dObj.validStartTime,success:function(obj){var tagName=obj.sourceId||'DateSubmit';Ta.util.pageHotClick(tagName);__this.afterFunc&&__this.afterFunc(__this);__this.set({'dateObj.startDate':$('#'+obj.mOpts.startDateId).val(),'dateObj.endDate':$('#'+obj.mOpts.endDateId).val(),'dateObj.needCompare':$('#'+obj.mOpts.compareCheckboxId).val(),'dateObj.startCompareDate':$('#'+obj.mOpts.startCompareDateId).val(),'dateObj.endCompareDate':$('#'+obj.mOpts.endCompareDateId).val()});}});__this.set({'dateObj.startDate':$('#'+this.dateRange.startDateId).val(),'dateObj.endDate':$('#'+this.dateRange.endDateId).val(),'dateObj.needCompare':$('#'+this.dateRange.compareCheckboxId).attr('checked')?1:0,'dateObj.startCompareDate':$('#'+this.dateRange.startCompareDateId).val(),'dateObj.endCompareDate':$('#'+this.dateRange.endCompareDateId).val()});},assembly:function(type){var arr=[];for(var p in this.dateObj){this.dateObj[p]&&arr.push(p+"="+this.dateObj[p]);}
for(var p in this.extraParams){this.extraParams[p]&&arr.push(p+"="+this.extraParams[p]);}
return'ajax=1&func='+type+'&'+arr.join('&')+'&'+this.condition.getResult(type);},reload:function(){var obj=this.ajaxObj;obj.error=function(msg){if(typeof(msg)=='string')
{Ta.util.showMessage('系统出错了！',msg,'',Ta.Dialog.DIALOG_TYPE.TEXT_WARN,Ta.Dialog.BUTTON_TYPE.OK);}}
var __this=this;obj.success=function(msg){try{Ta.util.loadAjaxData(msg);}catch(err){var info="Error name: "+err.name+";\r\nError message: "+err.message+";";Ta.util.showMessage('系统出错了！',info,'',Ta.Dialog.DIALOG_TYPE.TEXT_WARN,Ta.Dialog.BUTTON_TYPE.OK);}finally{}}
obj.complete=function(){Ta.util.mask.clear('container');}
obj.timeout=25000;Ta.util.mask.show('container');Ta.ajax(obj);},exportFile:function(type){var type=type||'table';var url=this.baseUrl+(~this.baseUrl.indexOf('?')?'&':'?')+'sId='+Ta.module.site.sid+'&export=1&'+this.assembly(type)+'&random='+(+new Date())+'&ajax=0';Ta.util.pageHotClick('EXPORT');window.location.href=url;return false;},renderAll:function(){if(requestType=='table'||requestType=='chart'){this.render(requestType);}else{this.render('table');this.render('chart');}},render:function(type){this.set({'ajaxObj.url':this.baseUrl,'ajaxObj.dataType':'html','ajaxObj.data':this.assembly(type)});},clearExtraParams:function(){this.extraParams={};}}))();}};Ta.Page.init();/*  |xGv00|24c57ed6318e38ee43eea38275951bc5 */